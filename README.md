# Stateless App Runner

A lightweight, stateless application runner built with FastAPI. This service allows you to execute HTML/JS applications that are encoded directly into the URL, ensuring that the application state is contained entirely within the link itself.

[You can see how it work here.](https://mtlminiapps.us/?d=eNq1GEuP2kb4zq-YddUAuxjMa7PLwh6yyUqRmrTKJqqiNJUGewzTNR40HsOSh5T00kMqVeolUk89Vb01irLabaq0h_wB84_6jW3AL2BpVBDGM9_7OZ_d3rr55dH9h1_dQn0xsA5zbfmHLGz3Ogp3FblBsHGYQ_BpD4jASO9j7hDRUR7cP1b3lCjIxgPSUUaUjIeMCwXpzBbEBtQxNUS_Y5AR1YnqL0qI2lRQbKmOji3SqZa1GStBhUUOb2J-iu4wg6AjbOmuhQXj7UoAC_AcMZndy0-XGRP0dL6UnwHmPWq3kHYQ2x5iw6B2L7XfJ7TXFy1U1bRRPw4yqDO08KSFTIucxUHfuY6g5kQNjW0hHa6Ex5GwRXu2SgUZONkIXayf9jhzbQMYWYy30GdVIr9xNBOEqCYeUAt0UfFwaBHVmTjAt4RuWNQ-vYP1E399DJglpJyQHiPowW2lhO6xLhOshBxsO6pDODXjvNmIcNNi4xbqU8Mg9gL6PDe_LevzaCScnWFBzZDfJc6vacOEJ7uMG4SrHBvUdbIRzlSnjw2po-bDUVNeeK-LC1rJ_5abxTiRn24tVI-zi5oUBne9PZqWyJgZoIENsqcdoMo28v6YvvDee5fen8i78M69v-D3YfoKltuV5aHMHzGXU8LRXTLOl9CA2cwZYj0r-g59QsA55SYngzhYkDOh-pnWQlym8n_1fLWWRAgqSYUEEmyQxWGWPOpZC2FXsCXQSTq5_Bj1oTRU3-IWstmY42F2ae6mBK-ozLVFlypdyUMltpGZJxDcE50zy-pijmTzAWdCSPhMhWiAZznVaqlj0j2lELY56dO5NQ0wBiRcgUgVfXfQBdJFVkLa1ev1g1TVBDwXTLsuxAwqvsepkUjxue8kLO4auaOC5wAOkYE8dwc2cOdkSLAoNEqoavJiBomMvcrZGHB3m8lY9fAwmVwRTQNFk1XoWyeTwiarc7aRlBaplmpGtfjgcRiJZqqyXe7I0h4yms6bWdmbprm2i9eJ_CYKlUMLhtOPQaFiy0JaueogrAs6SiC60KahVVtEF1ku-P9PpVjDBQ_DNdZsa8UVoWwFJiUi6hsPZQNtxL-VCfawALyLy2XHTU8L6ssGk5BjUkvIzOn6rdAmjlOolqvFZaXt_ea99c6n33t_e2-hXZ-j6UtYXEL_vowVdlfYKidGrBTnwSZmAz6xmpb4DOzskWwSc_96vbobJYnT9jghUBRo7Vlb05tNcoDSJcmlB6G32qgenFA_T19NX4Kd7703058Q_H2AxT9y2UJg8zncn09fTH9Edd8JcJ5J3MvkARYZlz6PyI31HjDgCeEsERpfraCnhJrVAs1-9y5DaUnNosIDV7Ur4QDYrgQjaltOgIe5XNugI6Rb2HE6ymJamU2XEWBYPgqixmJxqLUrgJPGjvZRZTF2trdUFUarMaoiVY1sh91sRhxkjYKYrVtUPwXNLIL5zUBooagcHrUrAclKHkEmRdjACAjnVSFfyQOPjxefxmTbZ_L605iokom64JH2VC3TUylG1yWj68uVSRHsSYK9DQj2JcH-p5m7I3nsrDK3fjVzG5JRYwPtm5KguQHBriTYTRPEVfZ-iVSd96v3BvoibCC4vJn-AB0R_mWjlOPtO7h5CY0CmgMA3gXbEv3Su_AJki1kTYn4zS5aJGH5ElkhnVVOblzNyVXpguoGPqtJgtoGBHVJUF_nZKlyc503ZOfMyDhNStA2UKksCcpxgrDJhX-5NkyadCgCGMwMjphPtR1kMN0dwHRQ7hFxyyLy9sbkNjAOUfLhoWoRgcjZkMNRC6MNEObzCwB17hHHtQRsm9hy5Enlw0zX1uUkhEJt5euFYuS8oCYqzGmvXUNbj6DkSgjaDFy25aWSf1ymYLNrECcgLybOm0ylEkMUsLAJvw-PUBJHSyCltF8cRojAOqZmUvwK4lzMzgxVOr4y6NkztAR4i3PG8ymRwE26Am1JnHIKvtTwhN3Pc-m7-Y0M64g6LraOpKiO_2roIJfSwdcTzpY4cv7j6_wy5Eoa-SKCnFtuwk4nQrigiGTATlLPFLfgqesLYkqPxDe_li8TAtLnifyNH-gRf69NsKXpmZ04KcGLJhmRKvgkIye2FrKK8DAnXJ54Ek9RVB59q6n7O9-o25Xy40pZEEcUIkyyEkv0YeRENhkjPzkLym17BI8aRvDqUCkmUyy2lEnFZ1YToItKS4y3afOocyzfK5ICDysRCoc6d_Hd2cYm-qY1XSp8rvFQvhw9thg8JAd7ZcGO6RkxCnvF4gpXZyVJwOBgeSubSzgRnNq9QnFp0xLcjfUsHQu9jwqkmP1GIJ6rQYs5uHpLXS44TGCY3cPzBm6DsR2mePkC-l__0HOU&s=4f6cc4a5c46a27d47b4ee983870fe417da42660cdeb799f28a3cb663dc1f08d5)

## Features

- **Stateless Execution**: Applications are delivered via URL parameters.
- **Security**: URL payloads are signed with a server-side secret key to prevent tampering.
- **Compression**: Payloads are zlib-compressed to minimize URL length.
- **Admin Interface**: Built-in tool to generate signed links from HTML/JS code.
- **Dockerized**: Ready to deploy with Docker and Docker Compose.

## Quick Start

### Prerequisites

- Docker
- Docker Compose

### Running the Application

1. (Optional) Pull the latest image:

   ```bash
   docker pull ghcr.io/montelibero/stateless_app_runner:latest
   ```

2. Clone the repository and navigate to the project root.
3. Start the service:

   ```bash
   docker-compose up -d
   ```

4. Access the application:
   - **Runner**: `http://localhost/` (will show a default message if no payload is provided)
   - **Admin/Generator**: `http://localhost/admin`

### Generating a Link

1. Go to `http://localhost/admin`.
2. Enter the HTML/JS code you want to run.
3. Click "Generate".
4. The system will provide a signed URL. Opening this URL will render and execute your code.

## Configuration

The application is configured via environment variables in `docker-compose.yml`:

- `APP_DOMAIN`: The base domain for generated links (default: `http://mtlminiapps.us`).
- `SECRET_KEY`: A secret key used to sign and verify payloads.
  - **Important**: If not set, the server will generate a random key on startup and log it to the console. For production consistency, set this variable.

## Development

To run tests locally:

```bash
# Install dependencies
pip install -r app/requirements.txt

# Run tests
pytest
```

## How it Works

1. **Compression**: The HTML content is compressed using `zlib` (level 9).
2. **Encoding**: The compressed data is encoded using `base64` (URL-safe).
3. **Signing**: An HMAC-SHA256 signature is generated using the `SECRET_KEY`.
4. **Execution**: When the link is opened, the server verifies the signature, decodes, decompresses, and serves the content.
